<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rebuild the report database — orderly_rebuild • orderly</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Rebuild the report database — orderly_rebuild" />

<meta property="og:description" content="Rebuild the report database.  This is necessary when the orderly
  database schema changes, and you will be prompted to run this
  function after upgrading orderly in that case." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">orderly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/orderly.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/changelog.html">orderly changelog</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vimc/orderly">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rebuild the report database</h1>
    <small class="dont-index">Source: <a href='https://github.com/vimc/orderly/blob/master/R/db.R'><code>R/db.R</code></a></small>
    <div class="hidden name"><code>orderly_rebuild.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Rebuild the report database.  This is necessary when the orderly
  database schema changes, and you will be prompted to run this
  function after upgrading orderly in that case.</p>
    
    </div>

    <pre class="usage"><span class='fu'>orderly_rebuild</span>(<span class='kw'>root</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>locate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>if_schema_changed</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>root</th>
      <td><p>The path to an orderly root directory, or <code>NULL</code>
(the default) to search for one from the current working
directory if <code>locate</code> is <code>TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>locate</th>
      <td><p>Logical, indicating if the configuration should be
searched for.  If <code>TRUE</code> and <code>config</code> is not given,
then orderly looks in the working directory and up through its
parents until it finds an <code>orderly_config.yml</code> file.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical, indicating if information about the
rebuild should be printed as it runs</p></td>
    </tr>
    <tr>
      <th>if_schema_changed</th>
      <td><p>Logical, indicating if the rebuild should
take place only if the schema has changed.  This is designed to
be safe to use in (say) deployment scripts because it will be
fast enough to call regularly.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The report database (orderly's "destination" database) is
essentially an index over all the metadata associated with
reports.  It is used by orderly itself, and can be used by
applications that extend orderly (e.g.,
<a href='https://github.com/vimc/orderly-web'>OrderlyWeb</a>).  All the
data in this database can be rebuilt from files stored with the
committed (archive) orderly reports, using the
<code>orderly_rebuild</code> function.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>path</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/orderly/topics/orderly_example'>orderly_example</a></span>(<span class='st'>"minimal"</span>)
<span class='no'>id</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/orderly/topics/orderly_run'>orderly_run</a></span>(<span class='st'>"example"</span>, <span class='kw'>root</span> <span class='kw'>=</span> <span class='no'>path</span>)</div><div class='output co'>#&gt; <span class='message'>[ name       ]  example</span></div><div class='output co'>#&gt; <span class='message'>[ id         ]  20190813-162456-e81d995b</span></div><div class='output co'>#&gt; <span class='message'>[ data       ]  source =&gt; dat: 20 x 2</span></div><div class='output co'>#&gt; <span class='message'>[ start      ]  2019-08-13 16:24:56</span></div><div class='output co'>#&gt; 
#&gt; &gt; png("mygraph.png")
#&gt; 
#&gt; &gt; par(mar = c(15, 4, 0.5, 0.5))
#&gt; 
#&gt; &gt; barplot(setNames(dat$number, dat$name), las = 2)</div><div class='output co'>#&gt; 
#&gt; &gt; dev.off()
#&gt; pdf 
#&gt;   2 </div><div class='output co'>#&gt; <span class='message'>[ end        ]  2019-08-13 16:24:56</span></div><div class='output co'>#&gt; <span class='message'>[ elapsed    ]  Ran report in 0.01233292 secs</span></div><div class='output co'>#&gt; <span class='message'>[ artefact   ]  mygraph.png: 7360cb2eed3327ff8a677b3598ed7343</span></div><div class='input'><span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/orderly/topics/orderly_commit'>orderly_commit</a></span>(<span class='no'>id</span>, <span class='kw'>root</span> <span class='kw'>=</span> <span class='no'>path</span>)</div><div class='output co'>#&gt; <span class='message'>[ commit     ]  example/20190813-162456-e81d995b</span></div><div class='output co'>#&gt; <span class='message'>[ copy       ]</span></div><div class='output co'>#&gt; <span class='message'>[ import     ]  example:20190813-162456-e81d995b</span></div><div class='output co'>#&gt; <span class='message'>[ success    ]  :)</span></div><div class='output co'>#&gt; [1] "/tmp/RtmpC4lmv4/filed422c5e97/archive/example/20190813-162456-e81d995b"</div><div class='input'>
<span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/orderly/topics/orderly_db'>orderly_db</a></span>(<span class='st'>"destination"</span>, <span class='kw'>root</span> <span class='kw'>=</span> <span class='no'>path</span>)
<span class='kw pkg'>DBI</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/DBI/topics/dbReadTable'>dbReadTable</a></span>(<span class='no'>con</span>, <span class='st'>"report_version"</span>)</div><div class='output co'>#&gt;                         id  report                date displayname description
#&gt; 1 20190813-162456-e81d995b example 2019-08-13 16:24:56        &lt;NA&gt;        &lt;NA&gt;
#&gt;   connection published git_sha git_branch git_clean
#&gt; 1          0         0    &lt;NA&gt;       &lt;NA&gt;        NA</div><div class='input'><span class='kw pkg'>DBI</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/DBI/topics/dbDisconnect'>dbDisconnect</a></span>(<span class='no'>con</span>)

<span class='co'># The database can be removed and will be rebuilt if requested</span>
<span class='co'># (this is only a good idea if you do not extend the database with</span>
<span class='co'># your own fields - only the fields that orderly looks after can</span>
<span class='co'># be recovered!)</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/files'>file.remove</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='no'>path</span>, <span class='st'>"orderly.sqlite"</span>))</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/orderly/topics/orderly_rebuild'>orderly_rebuild</a></span>(<span class='no'>path</span>)</div><div class='output co'>#&gt; <span class='message'>[ rebuild    ]  db</span></div><div class='output co'>#&gt; <span class='message'>20190813-162456-e81d995b (example)</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/files'>file.exists</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='no'>path</span>, <span class='st'>"orderly.sqlite"</span>))</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='no'>con</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/orderly/topics/orderly_db'>orderly_db</a></span>(<span class='st'>"destination"</span>, <span class='kw'>root</span> <span class='kw'>=</span> <span class='no'>path</span>)
<span class='kw pkg'>DBI</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/DBI/topics/dbReadTable'>dbReadTable</a></span>(<span class='no'>con</span>, <span class='st'>"report_version"</span>)</div><div class='output co'>#&gt;                         id  report                date displayname description
#&gt; 1 20190813-162456-e81d995b example 2019-08-13 16:24:56        &lt;NA&gt;        &lt;NA&gt;
#&gt;   connection published git_sha git_branch git_clean
#&gt; 1          0         0    &lt;NA&gt;       &lt;NA&gt;        NA</div><div class='input'><span class='kw pkg'>DBI</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/DBI/topics/dbDisconnect'>dbDisconnect</a></span>(<span class='no'>con</span>)

<span class='co'># It is safe to rebuild a database repeatedly, though this can be</span>
<span class='co'># slow with larger databases.</span>
<span class='kw pkg'>orderly</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/orderly/topics/orderly_rebuild'>orderly_rebuild</a></span>(<span class='no'>path</span>)</div><div class='output co'>#&gt; <span class='message'>[ rebuild    ]  db</span></div><div class='output co'>#&gt; <span class='message'>20190813-162456-e81d995b (example)</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rich FitzJohn, Robert Ashton, Alex Hill, Martin Eden, Wes Hinsley, Emma Russell, James Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

